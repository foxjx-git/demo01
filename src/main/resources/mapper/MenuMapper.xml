<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.my.mydemo_01.mapper.MenuMapper">
    <select id="selectMenuByRoleEntiy" parameterType="com.my.mydemo_01.entity.RoleEntity"
            resultType="com.my.mydemo_01.entity.MenuEntity">
        select distinct m.menu_id, m.menu_name, m.menu_type, m.url, m.creator, m.create_time, m.update_time, m.is_delete,m.menu_key
        from t_liu_menu m
        join r_role_menu rrm on m.menu_id=rrm.menu_id
        where 1=1
        <if test="roleEntities == null or roleEntities.size() == 0">
            AND 1=0
        </if>
        <if test="roleEntities != null and roleEntities.size() > 0">
            and rrm.role_id in
            <foreach item="roleEntity" index="index" collection="roleEntities" open="(" separator="," close=")" >
                #{roleEntity.roleId}
            </foreach>
        </if>

    </select>
    <select id="countUserIdByMenuKey" parameterType="java.lang.String" resultType="int">
        select count(*)
        from r_user_role ur
        join r_role_menu rm on ur.role_id=rm.role_id
        join t_liu_menu menu on rm.menu_id =menu.menu_id
        where ur.user_id=#{userId}
            and menu.menu_key=#{menuKey}
    </select>

</mapper>
